FROM alpine:latest

#RUN apk --no-cache add ca-certificates tzdata && \
#    cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && \
#    echo "Asia/Shanghai" > /etc/timezone && \
#    rm -rf /var/cache/apk/*
RUN apk --no-cache add ca-certificates tzdata libc6-compat && \
    cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && \
    echo "Asia/Shanghai" > /etc/timezone && \
    rm -rf /var/cache/apk/*

WORKDIR /app

COPY cronjob /app/cronjob
COPY migrations /app/migrations
RUN mkdir -p /app/config
RUN mkdir -p /app/logs

RUN chmod +x /app/cronjob

EXPOSE 8082

CMD ["/app/cronjob", "-config=./config/config.yaml", "-env=product"]
